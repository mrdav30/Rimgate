<?xml version="1.0" encoding="utf-8"?>
<Defs>

	<QuestScriptDef>
		<defName>Rimgate_StargateSiteTauriScript</defName>
		<rootSelectionWeight>0.6</rootSelectionWeight>
		<rootMinPoints>0</rootMinPoints>
		<autoAccept>true</autoAccept>
		<defaultChallengeRating>2</defaultChallengeRating>
		<questNameRules>
			<rulesStrings>
				<li>questName->[adj] forward [site]</li>
				<li>adj->Lost</li>
				<li>adj->Abandoned</li>
				<li>adj->Remote</li>
				<li>site->outpost</li>
				<li>site->base</li>
				<li>site->facility</li>
			</rulesStrings>
		</questNameRules>
		<questDescriptionRules>
			<rulesStrings>
				<li>questDescription(askerIsNull==true)->Glyphs reference a constructed site tied to an operational gate.\n\nThe style suggests human hands—advanced, yet familiar. Whether military forward post, research hub, or derelict supply depot, it remains uncharted territory.\n\nExploration is advised, but caution is paramount.</li>
			</rulesStrings>
		</questDescriptionRules>
		<root Class="QuestNode_Sequence">
			<nodes>
				<li Class="QuestNode_SubScript">
					<def>Util_GetDefaultRewardValueFromPoints</def>
				</li>

				<li Class="QuestNode_GetMap" />

				<li Class="QuestNode_IsSet">
					<name>asker</name>
					<elseNode Class="QuestNode_RandomNode">
						<nodes>
							<li Class="QuestNode_Set">
								<name>askerIsNull</name>
								<value>true</value>
								<selectionWeight>0.4</selectionWeight>
							</li>
						</nodes>
					</elseNode>
				</li>

				<li Class="QuestNode_GetSiteTile">
					<storeAs>siteTile</storeAs>
					<preferCloserTiles>false</preferCloserTiles>
				</li>

				<li Class="QuestNode_GetSitePartDefsByTagsAndFaction">
					<storeAs>sitePartDefs</storeAs>
					<storeFactionAs>siteFaction</storeFactionAs>
					<sitePartsTags>
						<li>
							<tag>Rimgate_StargateSiteTauri</tag>
						</li>
						<li>
							<tag>Rimgate_SoldierReplicator</tag>
							<chance>0.5</chance>
						</li>
						<li>
							<tag>Rimgate_SoldierGoauld</tag>
							<chance>0.5</chance>
						</li>
						<li>
							<tag>KCSG_EnnemiesPresence</tag>
							<chance>0.5</chance>
						</li>
					</sitePartsTags>
				</li>

				<li Class="QuestNode_GetDefaultSitePartsParams">
					<tile>$siteTile</tile>
					<faction>$siteFaction</faction>
					<sitePartDefs>$sitePartDefs</sitePartDefs>
					<storeSitePartsParamsAs>sitePartsParams</storeSitePartsParamsAs>
				</li>

				<li Class="QuestNode_SubScript">
					<def>Util_GenerateStargateSite</def>
					<parms>
						<hiddenSitePartsPossible>true</hiddenSitePartsPossible>
					</parms>
				</li>

				<li Class="QuestNode_SpawnWorldObjects">
					<worldObjects>$site</worldObjects>
				</li>

				<li Class="Rimgate.QuestNode_RaidStargateComplex">
					<address>$site</address>
				</li>

				<li Class="QuestNode_WorldObjectTimeout">
					<worldObject>$site</worldObject>
					<isQuestTimeout>true</isQuestTimeout>
					<delayTicks>900000</delayTicks>
					<node Class="QuestNode_Sequence">
						<nodes>
							<li Class="QuestNode_Letter">
								<label>Quest expired: [resolvedQuestName]</label>
								<text>The site has been swept clean. Equipment gone, power drained, gate dismantled. A faint smell of ozone lingers, as if someone just closed the door. Another mystery, lost to time.</text>
							</li>

							<li Class="QuestNode_End">
								<outcome>Fail</outcome>
							</li>
						</nodes>
					</node>
				</li>

				<li Class="QuestNode_NoWorldObject">
					<worldObject>$site</worldObject>
					<node Class="QuestNode_End" />
				</li>

			</nodes>
		</root>
	</QuestScriptDef>

</Defs>