<?xml version="1.0" encoding="utf-8"?>
<Defs>

	<QuestScriptDef>
		<defName>Rimgate_GateQuestScript_Orbit</defName>
		<rootSelectionWeight>0</rootSelectionWeight>
		<isRootSpecial>true</isRootSpecial>
		<autoAccept>true</autoAccept>
		<defaultChallengeRating>4</defaultChallengeRating>
		<randomlySelectable>false</randomlySelectable>
		<canOccurOnAllPlanetLayers>true</canOccurOnAllPlanetLayers>
		<everAcceptableInSpace>true</everAcceptableInSpace>
		<questNameRules>
			<rulesStrings>
				<li>questName->[adj] signal [site]</li>
				<li>questName->[adj] gate [site]</li>
				<li>questName->[adj] derelict [site]</li>
				<li>questName->[adj] anomaly [site]</li>

				<li>adj->Orbital</li>
				<li>adj->Stellar</li>
				<li>adj->Voidborne</li>
				<li>adj->Drifting</li>
				<li>adj->Silent</li>
				<li>adj->Cold</li>
				<li>adj->Dark</li>
				<li>adj->Faint</li>
				<li>adj->Distant</li>
				<li>adj->Remote</li>
				<li>adj->Lost</li>
				<li>adj->Abandoned</li>
				<li>adj->Derelict</li>
				<li>adj->Uncharted</li>
				<li>adj->Unmapped</li>
				<li>adj->Anomalous</li>

				<li>site->station</li>
				<li>site->platform</li>
				<li>site->outpost</li>
				<li>site->dock</li>
				<li>site->relay</li>
				<li>site->beacon</li>
				<li>site->habitat</li>
				<li>site->ring</li>
				<li>site->spindle</li>
				<li>site->ark</li>
				<li>site->array</li>
				<li>site->node</li>
				<li>site->hub</li>
				<li>site->terminal</li>
				<li>site->hulk</li>
				<li>site->wreck</li>
				<li>site->vault</li>
				<li>site->ruins</li>

			</rulesStrings>
		</questNameRules>

		<questDescriptionRules>
			<rulesStrings>
				<li>questDescription->A signal resolves into coordinates for a structure drifting in orbit.\n\nIts silhouette is all hard angles and silent bays, too old to be on any current charts. Beacon, depot, or trap, the void does not say.\n\nIf you go, go prepared.</li>
				<li>questDescription->The transmission pinpoints a derelict installation beyond the main trade lanes.\n\nNo registry, no flags, just a cold hull and a faint power signature. It may be empty, or it may be waiting.\n\nOnly a boarding team will tell.</li>
				<li>questDescription->Encrypted telemetry marks a gate-linked station hanging in the darkness.\n\nThe layout looks human-made but unfamiliar, as if built for a different gravity. Salvage could be significant, and so could the risk.\n\nProceed with caution.</li>
				<li>questDescription->A faint relay pulse ties back to an orbital site of unknown origin.\n\nThe structure is wrapped around a dormant gate, humming just enough to raise the hair on your arms. There is no traffic. There is no welcome.\n\nInvestigate at your discretion.</li>
				<li>questDescription->Coordinates resolve to a hulking wreck in a high orbit.\n\nThe hull is scarred and open to vacuum, but power still flickers inside. Loot, survivors, or something worse could be drifting within.\n\nSend a crew if you dare.</li>
				<li>questDescription->A clean signal points to a sealed platform tucked behind debris.\n\nLife support is minimal, the airlocks are cold, and the logs are wiped. Someone wanted this place quiet.\n\nTake it slow and keep your comms open.</li>
			</rulesStrings>
		</questDescriptionRules>

		<root Class="QuestNode_Sequence">
			<nodes>

				<li Class="QuestNode_Set">
					<name>askerIsNull</name>
					<value>true</value>
				</li>

				<li Class="QuestNode_RandomNode">
					<nodes>

						<!-- Mechanoids -->
						<li Class="QuestNode_Sequence">
							<nodes>
								<li Class="QuestNode_Set">
									<name>siteParts</name>
									<value>
										<li>Opportunity_MechanoidPlatform</li>
										<li>ItemStash</li>
										<li>Rimgate_SoldierMech</li>
									</value>
								</li>
								<li Class="QuestNode_SubScript">
									<def>Util_GenerateGateSite_Orbit</def>
									<parms>
										<siteFaction>Mechanoid</siteFaction>
									</parms>
								</li>
							</nodes>
						</li>

						<!-- Misc -->
						<li Class="QuestNode_Sequence">
							<nodes>
								<li Class="QuestNode_Set">
									<name>siteParts</name>
									<value>
										<li>OrbitalFugitivePlatform</li>
										<li>ItemStash</li>
										<li>KCSG_EnnemiesPresence</li>
									</value>
								</li>
								<li Class="QuestNode_Set">
									<name>siteFactionWhitelist</name>
									<value>
										<li>Salvagers</li>
										<li>AncientsHostile</li>
									</value>
								</li>
								<li Class="QuestNode_SubScript">
									<def>Util_GenerateGateSite_Orbit</def>
								</li>
							</nodes>
						</li>

						<li Class="QuestNode_Sequence">
							<nodes>
								<li Class="QuestNode_Set">
									<name>siteParts</name>
									<value>
										<li>Opportunity_AbandonedPlatform</li>
										<li>ItemStash</li>
										<li>KCSG_EnnemiesPresence</li>
									</value>
								</li>
								<li Class="QuestNode_Set">
									<name>siteFactionWhitelist</name>
									<value>
										<li>Salvagers</li>
										<li>AncientsHostile</li>
									</value>
								</li>
								<li Class="QuestNode_SubScript">
									<def>Util_GenerateGateSite_Orbit</def>
								</li>
							</nodes>
						</li>

						<li Class="QuestNode_Sequence">
							<nodes>
								<li Class="QuestNode_Set">
									<name>siteParts</name>
									<value>
										<li>Opportunity_OrbitalWreck</li>
										<li>ItemStash</li>
										<li>KCSG_EnnemiesPresence</li>
									</value>
								</li>
								<li Class="QuestNode_Set">
									<name>siteFactionWhitelist</name>
									<value>
										<li>Salvagers</li>
										<li>AncientsHostile</li>
									</value>
								</li>
								<li Class="QuestNode_SubScript">
									<def>Util_GenerateGateSite_Orbit</def>
								</li>
							</nodes>
						</li>

					</nodes>
				</li>

				<li Class="Rimgate.QuestNode_SetSiteQuestId" />

				<!-- Start custom detection raids once the site map generates -->
				<li Class="Rimgate.QuestNode_RaidStargateComplex" />

				<!-- <li Class="Rimgate.QuestNode_SpawnPawnsOnMap">
					<inSignal>site.MapGenerated</inSignal>
					<countRange>0~1</countRange>
					<factionDef>Rimgate_TreasureHuntersHostile</factionDef>
					<pawnKind>Rimgate_TreasureHunter</pawnKind>
					<skipChance>0.45</skipChance>
					<spawnNearGate>true</spawnNearGate>
				</li> -->

				<li Class="QuestNode_WorldObjectTimeout">
					<worldObject>$site</worldObject>
					<isQuestTimeout>true</isQuestTimeout>
					<delayTicks>900000</delayTicks>
					<node Class="QuestNode_Sequence">
						<nodes>
							<li Class="QuestNode_RandomNode">
								<nodes>
									<li Class="QuestNode_Letter">
										<label>Quest expired: [resolvedQuestName]</label>
										<text>By the time you mobilized, the site had already been disturbed. Faded symbols mark the walls, and the gate stands silent. Whatever treasure or terror it once held is gone for now.</text>
									</li>
									<li Class="QuestNode_Letter">
										<label>Quest expired: [resolvedQuestName]</label>
										<text>By the time you mobilized, others had already stripped the site bare.\n\nThe gate is gone, the tech salvaged, and the opportunity lost to the void.\n\nNext time, burn harder and move faster.</text>
									</li>
									<li Class="QuestNode_Letter">
										<label>Quest expired: [resolvedQuestName]</label>
										<text>The site has been swept clean. Equipment gone, power drained, gate dismantled. A faint tang of ozone hangs in the airlocks, as if someone just closed the hatch. Another mystery, lost to the drift.</text>
									</li>
									<li Class="QuestNode_Letter">
										<label>Quest expired: [resolvedQuestName]</label>
										<text>Only echoes remained. The gate is gone, stripped by unseen hands. The resonance lingers in the bulkheads, leaving your crew uneasy. Some things are best left drifting.</text>
									</li>
								</nodes>
							</li>

							<li Class="QuestNode_End">
								<outcome>Fail</outcome>
							</li>
						</nodes>
					</node>
				</li>

				<li Class="QuestNode_NoWorldObject">
					<worldObject>$site</worldObject>
					<node Class="QuestNode_End" />
				</li>

			</nodes>
		</root>
	</QuestScriptDef>

</Defs>
