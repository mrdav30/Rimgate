<?xml version="1.0" encoding="utf-8"?>
<Defs>

	<QuestScriptDef>
		<defName>Rimgate_StargateSiteGoauldScript</defName>
		<rootSelectionWeight>0.6</rootSelectionWeight>
		<rootMinPoints>0</rootMinPoints>
		<autoAccept>true</autoAccept>
		<defaultChallengeRating>1</defaultChallengeRating>
		<questNameRules>
			<rulesStrings>
				<li>questName->[adj] glyph [site]</li>
				<li>adj->Forbidden</li>
				<li>adj->Shrouded</li>
				<li>adj->Hidden</li>
				<li>site->chamber</li>
				<li>site->vault</li>
				<li>site->complex</li>
			</rulesStrings>
		</questNameRules>
		<questDescriptionRules>
			<rulesStrings>
				<li>questDescription(askerIsNull==true)->A sequence of glyphs leads to a site of unusual construction.\n\nThe architecture resembles something far older than your colony, and its purpose is unclear. Vault? Temple? Prison?\n\nOne thing is certain: whatever lies beyond was meant to remain sealed.</li>
			</rulesStrings>
		</questDescriptionRules>
		<root Class="QuestNode_Sequence">
			<nodes>
				<li Class="QuestNode_SubScript">
					<def>Util_GetDefaultRewardValueFromPoints</def>
				</li>

				<li Class="QuestNode_GetMap" />

				<li Class="QuestNode_IsSet">
					<name>asker</name>
					<elseNode Class="QuestNode_RandomNode">
						<nodes>
							<li Class="QuestNode_Set">
								<name>askerIsNull</name>
								<value>true</value>
								<selectionWeight>0.4</selectionWeight>
							</li>
						</nodes>
					</elseNode>
				</li>

				<li Class="QuestNode_GetSiteTile">
					<storeAs>siteTile</storeAs>
					<preferCloserTiles>false</preferCloserTiles>
				</li>

				<li Class="Rimgate.QuestNode_GetFactionOfDef">
					<factionDef>Rimgate_GoauldBaal</factionDef>
					<storeAs>enemyFaction</storeAs>
				</li>

				<li Class="QuestNode_GetSitePartDefsByTagsAndFaction">
					<storeAs>sitePartDefs</storeAs>
					<storeFactionAs>siteFaction</storeFactionAs>
					<sitePartsTags>
						<li>
							<tag>Rimgate_StargateSiteGoauld</tag>
						</li>
						<li>
							<tag>Rimgate_SoldierGoauld</tag>
						</li>
					</sitePartsTags>
				</li>

				<li Class="QuestNode_GetDefaultSitePartsParams">
					<tile>$siteTile</tile>
					<faction>$siteFaction</faction>
					<sitePartDefs>$sitePartDefs</sitePartDefs>
					<storeSitePartsParamsAs>sitePartsParams</storeSitePartsParamsAs>
				</li>

				<li Class="QuestNode_SubScript">
					<def>Util_GenerateSite</def>
					<parms>
						<hiddenSitePartsPossible>true</hiddenSitePartsPossible>
					</parms>
				</li>

				<li Class="QuestNode_SpawnWorldObjects">
					<worldObjects>$site</worldObjects>
				</li>

				<li Class="Rimgate.QuestNode_AddStargateAddresses">
					<address>$site</address>
					<remove>false</remove>
				</li>

				<li Class="Rimgate.QuestNode_RaidStargateComplex">
					<address>$site</address>
				</li>

				<li Class="QuestNode_WorldObjectTimeout">
					<worldObject>$site</worldObject>
					<isQuestTimeout>true</isQuestTimeout>
					<delayTicks>1800000</delayTicks>
					<inSignalDisable>site.MapGenerated</inSignalDisable>
					<node Class="QuestNode_Sequence">
						<nodes>
							<li Class="QuestNode_Letter">
								<label>Quest expired: [resolvedQuestName]</label>
								<text>By the time you mobilized, the site had already been disturbed. Faded symbols mark the walls, and the gate stands silent. Whatever treasure or terror it once held is gone… for now.</text>
							</li>

							<li Class="QuestNode_End">
								<outcome>Fail</outcome>
							</li>
						</nodes>
					</node>
				</li>

				<li Class="QuestNode_NoWorldObject">
					<worldObject>$site</worldObject>
					<node Class="QuestNode_End" />
				</li>
			</nodes>
		</root>
	</QuestScriptDef>

</Defs>