<?xml version="1.0" encoding="UTF-8"?>
<Defs>


    <!-- ======================= Cloning pod ======================= -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_WraithCloningPod</defName>
        <label>Cloning pod</label>
        <description>A tall, grotesque biotank filled with fluorescent goo and questionable ethics. The Wraith cloning pod allows rapid gestation of bioengineered pawns. Just add biomass and a touch of hubris.\n\nRequires a skilled Doctor's time and a lot of power to operate.</description>
        <descriptionHyperlinks>
            <ThingDef>Rimgate_Biomass</ThingDef>
        </descriptionHyperlinks>
        <thingClass>Rimgate.Building_CloningPod</thingClass>
        <containedPawnsSelectable>true</containedPawnsSelectable>

        <graphicData>
            <texPath>Things/Building/Misc/RGWraithCloningPod</texPath>
            <graphicClass>Graphic_Multi</graphicClass>
            <drawSize>(2, 3)</drawSize>
            <addTopAltitudeBias>true</addTopAltitudeBias>
        </graphicData>
        <uiIconPath>Things/Building/Misc/RGWraithCloningPodIcon</uiIconPath>

        <researchPrerequisites>
            <li>Rimgate_WraithCloneGenome</li>
        </researchPrerequisites>
        <castEdgeShadows>false</castEdgeShadows>
        <altitudeLayer>Building</altitudeLayer>
        <stealable>false</stealable>
        <passability>PassThroughOnly</passability>
        <pathCost>70</pathCost>
        <blockWind>true</blockWind>
        <fillPercent>0.5</fillPercent>
        <canOverlapZones>false</canOverlapZones>
        <statBases>
            <WorkToBuild>3200</WorkToBuild>
            <MaxHitPoints>250</MaxHitPoints>
            <Flammability>1.0</Flammability>
            <Mass>70</Mass>
        </statBases>
        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>BuildingsProduction</li>
        </thingCategories>
        <tickerType>Normal</tickerType>
        <drawerType>RealtimeOnly</drawerType>
        <size>(2,3)</size>
        <designationCategory>Biotech</designationCategory>
        <hasInteractionCell>true</hasInteractionCell>
        <interactionCellOffset>(0,0,2)</interactionCellOffset>
        <rotatable>true</rotatable>
        <defaultPlacingRot>South</defaultPlacingRot>
        <building>
            <buildingTags>
                <li>Biotech</li>
            </buildingTags>
            <ai_chillDestination>false</ai_chillDestination>
            <uninstallWork>4500</uninstallWork>
            <destroySound>BuildingDestroyed_Metal_Small</destroySound>
            <isPlayerEjectable>true</isPlayerEjectable>
            <workTableRoomRole>Laboratory</workTableRoomRole>
        </building>
        <costList>
            <Steel>140</Steel>
            <Rimgate_Biomass>100</Rimgate_Biomass>
            <ComponentIndustrial>6</ComponentIndustrial>
            <Rimgate_Naquadria>4</Rimgate_Naquadria>
            <ComponentSpacer>2</ComponentSpacer>
        </costList>
        <placeWorkers>
            <li>PlaceWorker_PreventInteractionSpotOverlap</li>
            <li>PlaceWorker_ShowFacilitiesConnections</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>
        <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
        <constructionSkillPrerequisite>8</constructionSkillPrerequisite>

        <comps>
            <li Class="CompProperties_Flickable" />
            <li Class="CompProperties_Refuelable">
                <fuelConsumptionRate>0</fuelConsumptionRate>
                <fuelCapacity>250.0</fuelCapacity>
                <fuelLabel>Biomass</fuelLabel>
                <fuelGizmoLabel>Biomass</fuelGizmoLabel>
                <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
                <showAllowAutoRefuelToggle>true</showAllowAutoRefuelToggle>
                <drawOutOfFuelOverlay>false</drawOutOfFuelOverlay>
                <fuelFilter>
                    <thingDefs>
                        <li>Rimgate_Biomass</li>
                    </thingDefs>
                </fuelFilter>
            </li>
            <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <shortCircuitInRain>false</shortCircuitInRain>
                <basePowerConsumption>9200</basePowerConsumption>
                <idlePowerDraw>500</idlePowerDraw>
                <alwaysDisplayAsUsingPower>true</alwaysDisplayAsUsingPower>
                <powerUpgrades>
                    <li>
                        <researchProject>Rimgate_CloningPodOptimization</researchProject>
                        <factor>0.65</factor> <!-- 35% reduction -->
                    </li>
                </powerUpgrades>
            </li>
            <li Class="Rimgate.CompProperties_CloningPodAnimation">
                <backgroundGraphicData>
                    <texPath>FX/RGClonePodBackground</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <drawSize>(2, 3)</drawSize>
                </backgroundGraphicData>
                <fullGraphicData>
                    <texPath>FX/RGClonePodFull</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>TransparentPostLight</shaderType>
                    <drawSize>(2, 3)</drawSize>
                </fullGraphicData>
                <emptyGraphicData>
                    <texPath>FX/RGClonePodEmpty</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>TransparentPostLight</shaderType>
                    <drawSize>(2, 3)</drawSize>
                </emptyGraphicData>
                <incubatingStagesGraphicData>
                    <li>
                        <texPath>FX/RGClonePodIncubating_Stage1</texPath>
                        <graphicClass>Graphic_Single</graphicClass>
                        <shaderType>TransparentPostLight</shaderType>
                        <drawSize>1</drawSize>
                    </li>
                    <li>
                        <texPath>FX/RGClonePodIncubating_Stage2</texPath>
                        <graphicClass>Graphic_Single</graphicClass>
                        <shaderType>TransparentPostLight</shaderType>
                        <drawSize>1</drawSize>
                    </li>
                    <li>
                        <texPath>FX/RGClonePodIncubating_Stage3</texPath>
                        <graphicClass>Graphic_Single</graphicClass>
                        <shaderType>TransparentPostLight</shaderType>
                        <drawSize>1</drawSize>
                    </li>
                </incubatingStagesGraphicData>
            </li>
            <li Class="Rimgate.CompProperties_AnalyzableResearchWhen">
                <analysisID>1001000</analysisID>
                <requiresResearchDef>Rimgate_WraithBasic</requiresResearchDef>

                <!-- Analyzable -->

                <canStudyInPlace>true</canStudyInPlace>
                <destroyedOnAnalyzed>true</destroyedOnAnalyzed>
                <analysisDurationHours>6</analysisDurationHours>
                <completedLetterLabel>Cloning protocols recovered: {RESEARCH} unlocked</completedLetterLabel>
                <completedLetter>By dissecting the Wraith cloning pod, {PAWN_labelShort} has extracted viable growth-cycle notes and imprint scaffolding.\n\nThe biotank liquefied into sludge after exposure to atmosphere, leaving behind only the scent of ozone and regret.\n\n{RESEARCH} is now available at a research bench.</completedLetter>
                <completedLetterDef>PositiveEvent</completedLetterDef>

                <catastrophicFailureChance>0.25</catastrophicFailureChance>
                <catastrophicDestroysThing>true</catastrophicDestroysThing>
                <catastrophicExplosion>true</catastrophicExplosion>
                <catastrophicExplosionRadius>3.0</catastrophicExplosionRadius>
                <catastrophicExplosionDamage>60</catastrophicExplosionDamage>
                <catastrophicExplosionDamageDef>Bomb</catastrophicExplosionDamageDef>
                <catastrophicBlocksResearch>true</catastrophicBlocksResearch>

                <catastrophicLetterLabelKey>RG_AnalysisCatastrophicLabel</catastrophicLetterLabelKey>
                <catastrophicLetterTextKey>RG_AnalysisCatastrophicText</catastrophicLetterTextKey>

                <!-- Interactable -->

                <maintainProgress>true</maintainProgress>
                <activateTexPath>UI/Icons/Study</activateTexPath>

                <activateLabelString>Analyze...</activateLabelString>
                <activateDescString>Analyze the Wraith cloning pod.</activateDescString>
                <jobString>Analyzing cloning pod</jobString>
                <guiLabelString>Choose who should analyze this</guiLabelString>
                <inspectString>Can be analyzed by a colonist.</inspectString>

                <targetingParameters>
                    <canTargetBuildings>false</canTargetBuildings>
                    <canTargetAnimals>false</canTargetAnimals>
                    <canTargetMechs>false</canTargetMechs>
                    <onlyTargetControlledPawns>true</onlyTargetControlledPawns>
                </targetingParameters>
            </li>
            <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities>
                    <li>Rimgate_WraithBiomassStabilizer</li>
                    <li>Rimgate_WraithCyclicWaveInducer</li>
                </linkableFacilities>
            </li>
        </comps>
    </ThingDef>

    <!-- biomass stabilizer -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_WraithBiomassStabilizer</defName>
        <label>biomass stabilizer</label>
        <description>A pulsing organ-mass that conditions biomass for imprint growth. When linked to a cloning pod, it reduces waste during initiation. Up to four can be linked to a single pod.\n\nNote: This organ-mass degrades after each cloning cycle and must be replaced periodically.</description>
        <descriptionHyperlinks>
            <ThingDef>Rimgate_WraithCloningPod</ThingDef>
        </descriptionHyperlinks>
        <thingClass>Building</thingClass>

        <graphicData>
            <texPath>Things/Building/Misc/RGWraithBiomassStabilizer</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <drawSize>(1,1)</drawSize>
        </graphicData>

        <researchPrerequisites>
            <li>Rimgate_CloningPodOptimization</li>
        </researchPrerequisites>

        <altitudeLayer>Building</altitudeLayer>
        <passability>PassThroughOnly</passability>
        <pathCost>42</pathCost>
        <fillPercent>0.2</fillPercent>
        <castEdgeShadows>false</castEdgeShadows>

        <statBases>
            <MaxHitPoints>50</MaxHitPoints>
            <WorkToBuild>1200</WorkToBuild>
            <Flammability>0.9</Flammability>
            <Mass>12</Mass>
        </statBases>

        <size>(1,1)</size>
        <designationCategory>Biotech</designationCategory>
        <rotatable>false</rotatable>

        <building>
            <!-- decays when hooked up -->
            <repairable>false</repairable>
            <ai_chillDestination>false</ai_chillDestination>
            <buildingTags>
                <li>Biotech</li>
            </buildingTags>
            <workTableRoomRole>Laboratory</workTableRoomRole>
        </building>
        <placeWorkers>
            <li>PlaceWorker_ShowFacilitiesConnections</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>

        <comps>
            <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <basePowerConsumption>5</basePowerConsumption>
                <alwaysDisplayAsUsingPower>true</alwaysDisplayAsUsingPower>
                <shortCircuitInRain>false</shortCircuitInRain>
            </li>
            <li Class="CompProperties_Facility">
                <maxSimultaneous>4</maxSimultaneous>
                <mustBePlacedAdjacent>true</mustBePlacedAdjacent>
                <!-- <showMaxSimultaneous>false</showMaxSimultaneous> -->
            </li>
        </comps>

        <costList>
            <Steel>5</Steel>
            <Rimgate_Naquadria>1</Rimgate_Naquadria>
            <Rimgate_Biomass>1</Rimgate_Biomass>
            <ComponentIndustrial>1</ComponentIndustrial>
        </costList>

        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>BuildingsMisc</li>
        </thingCategories>
    </ThingDef>

    <!-- cyclic wave inducer -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_WraithCyclicWaveInducer</defName>
        <label>cyclic wave inducer</label>
        <description>A bioelectric resonator that entrains cloning cycles across nearby pods. Linked pods require less calibration work and incubate fasterâ€”but the inducer must remain powered.</description>
        <descriptionHyperlinks>
            <ThingDef>Rimgate_WraithCloningPod</ThingDef>
        </descriptionHyperlinks>
        <thingClass>Building</thingClass>

        <graphicData>
            <texPath>Things/Building/Misc/RGWraithCyclicWaveInducer</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <drawSize>(2,2)</drawSize>
        </graphicData>

        <researchPrerequisites>
            <li>Rimgate_CloningPodOptimization</li>
        </researchPrerequisites>

        <altitudeLayer>Building</altitudeLayer>
        <passability>PassThroughOnly</passability>
        <pathCost>55</pathCost>
        <fillPercent>0.2</fillPercent>
        <castEdgeShadows>false</castEdgeShadows>

        <statBases>
            <WorkToBuild>1600</WorkToBuild>
            <MaxHitPoints>160</MaxHitPoints>
            <Flammability>0.85</Flammability>
            <Mass>16</Mass>
        </statBases>

        <size>(2,2)</size>
        <designationCategory>Biotech</designationCategory>
        <rotatable>false</rotatable>

        <building>
            <ai_chillDestination>false</ai_chillDestination>
            <buildingTags>
                <li>Biotech</li>
            </buildingTags>
            <workTableRoomRole>Laboratory</workTableRoomRole>
        </building>
        <placeWorkers>
            <li>PlaceWorker_ShowFacilitiesConnections</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>

        <comps>
            <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <basePowerConsumption>200</basePowerConsumption>
                <idlePowerDraw>40</idlePowerDraw>
                <alwaysDisplayAsUsingPower>true</alwaysDisplayAsUsingPower>
                <shortCircuitInRain>false</shortCircuitInRain>
            </li>

            <li Class="CompProperties_Facility">
                <maxSimultaneous>1</maxSimultaneous>
                <maxDistance>12.9</maxDistance>
                <requiresLOS>false</requiresLOS>
                <showMaxSimultaneous>false</showMaxSimultaneous>
            </li>
        </comps>

        <costList>
            <Steel>55</Steel>
            <Rimgate_Biomass>20</Rimgate_Biomass>
            <Rimgate_Naquadria>4</Rimgate_Naquadria>
            <ComponentIndustrial>3</ComponentIndustrial>
            <ComponentSpacer>1</ComponentSpacer>
        </costList>

        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>BuildingsMisc</li>
        </thingCategories>
    </ThingDef>

</Defs>