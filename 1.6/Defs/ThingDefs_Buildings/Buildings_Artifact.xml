<?xml version="1.0" encoding="UTF-8"?>
<Defs>

    <!-- =============== Stargate Base =============== -->

    <ThingDef Name="Rimgate_StargateBase" ParentName="BuildingBase" Abstract="True">
        <thingClass>Rimgate.Building_Stargate</thingClass>
        <minifiedDef>MinifiedThing</minifiedDef>
        <stealable>false</stealable>
        <constructEffect>ConstructMetal</constructEffect>
        <altitudeLayer>BuildingOnTop</altitudeLayer>
        <fillPercent>0.20</fillPercent>
        <canOverlapZones>true</canOverlapZones>
        <leaveResourcesWhenKilled>true</leaveResourcesWhenKilled>
        <passability>PassThroughOnly</passability>
        <castEdgeShadows>false</castEdgeShadows>
        <pathCost>3</pathCost>
        <thingCategories>
            <li>Artifacts</li>
        </thingCategories>
        <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
        <tickerType>Normal</tickerType>
        <drawerType>RealtimeOnly</drawerType>
        <preventDroppingThingsOn>true</preventDroppingThingsOn>
        <hasInteractionCell>True</hasInteractionCell>
        <interactionCellOffset>(0,0,-1)</interactionCellOffset>
        <building>
            <ai_neverTrashThis>true</ai_neverTrashThis>
            <uninstallWork>6250</uninstallWork>
        </building>
        <placeWorkers>
            <li>PlaceWorker_PreventInteractionSpotOverlap</li>
            <li>Rimgate.PlaceWorker_Stargate</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>
        <comps>
            <li Class="CompProperties_Glower">
                <glowRadius>0</glowRadius> <!-- This is changed in C# -->
                <glowColor>(115,171,224,0)</glowColor>
            </li>
            <li Class="CompProperties_Transporter">
                <max1PerGroup>true</max1PerGroup>
                <massCapacity>999999</massCapacity>
            </li>
        </comps>
    </ThingDef>

    <!-- ======= Dwarfgate ======= -->

    <ThingDef ParentName="Rimgate_StargateBase">
        <defName>Rimgate_Stargate</defName>
        <label>Dwarfgate</label>
        <description>An ancient alien construct capable of instantaneous transit—but unlike the legendary Stargates of myth, these “Dwarfgates” are smaller, dimmer cousins. Their wormhole lattice is sealed into a closed planetary network; attempts to dial off-world fizzle as if an unseen hand blocks the path.
            \n\nRumors whisper that the Archotechs themselves tampered with them, corralling their use to a single world for inscrutable ends. Stranger still, scattered reports claim there are hundreds of such gates buried across the Rim—drawing fortune-seekers, warlords, and scholars alike to uncover the reason why they were left here… and what they are meant to protect.
            \n\n"By the time you get to the other side, you're frozen stiff. Like you'd just been through a blizzard... naked."</description>
        <size>(5,1)</size>
        <graphicData>
            <texPath>Things/Building/Artifact/RGStargateAncient</texPath>
            <graphicClass>Graphic_Multi</graphicClass>
            <drawSize>(5,5)</drawSize>
            <drawOffsetSouth>(0,0,0.85)</drawOffsetSouth>
            <drawOffsetNorth>(0,0,0.85)</drawOffsetNorth>
            <drawOffsetWest>(0,0,0)</drawOffsetWest>
            <drawOffsetEast>(0,0,0)</drawOffsetEast>
            <addTopAltitudeBias>true</addTopAltitudeBias>
        </graphicData>
        <techLevel>Archotech</techLevel>
        <killedLeavings>
            <Steel>120</Steel>
            <ComponentIndustrial>8</ComponentIndustrial>
            <ComponentSpacer>2</ComponentSpacer>
            <Rimgate_Naquadah>55</Rimgate_Naquadah>
        </killedLeavings>
        <statBases>
            <MarketValue>30000</MarketValue>
            <MaxHitPoints>6000</MaxHitPoints>
            <Flammability>0</Flammability>
            <Mass>290</Mass>
            <MeditationFocusStrength>0.24</MeditationFocusStrength>
        </statBases>
        <comps>
            <li Class="Rimgate.CompProperties_StargateControl">
                <puddleGraphicData>
                    <texPath>FX/RGEventHorizon</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>Mote</shaderType>
                    <drawSize>(5,5)</drawSize>
                </puddleGraphicData>
                <irisGraphicData>
                    <texPath>Things/Building/Misc/RGIris</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>Mote</shaderType>
                    <drawSize>(5,5)</drawSize>
                </irisGraphicData>
                <chevronHighlight>
                    <texPath>FX/RGStargateAncient_Active</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>Mote</shaderType>
                    <drawSize>(5,5)</drawSize>
                </chevronHighlight>
                <irisPowerConsumption>500</irisPowerConsumption>
            </li>
            <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <shortCircuitInRain>false</shortCircuitInRain>
                <basePowerConsumption>0</basePowerConsumption>
                <showPowerNeededIfOff>false</showPowerNeededIfOff>
            </li>
            <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities>
                    <li>Rimgate_DialHomeDevice</li>
                    <li>Rimgate_TauriDialHomeDevice</li>
                </linkableFacilities>
            </li>
            <li Class="CompProperties_MeditationFocus">
                <statDef>MeditationFocusStrength</statDef>
                <focusTypes>
                    <li>Natural</li>
                    <li>Void</li>
                </focusTypes>
                <offsets>
                    <li Class="FocusStrengthOffset_BuildingDefsLit">
                        <defs>
                            <li>Rimgate_DialHomeDevice</li>
                        </defs>
                        <offsetPerBuilding>0.05</offsetPerBuilding>
                        <radius>9.9</radius>
                        <maxBuildings>1</maxBuildings>
                        <explanationKey>MeditationFocusPerBuilding</explanationKey>
                        <explanationKeyAbstract>MeditationFocusPerBuildingAbstract</explanationKeyAbstract>
                        <drawRingRadius>false</drawRingRadius>
                    </li>
                </offsets>
            </li>
        </comps>
    </ThingDef>

    <!-- =============== DHD =============== -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_DialHomeDevice</defName>
        <thingClass>Rimgate.Building_DHD</thingClass>
        <label>Dial home device</label>
        <description>An ancient alien control console designed to interface with a Dwarfgate. Punch in the right sequence, and the universe becomes your backyard—assuming you don’t misdial into a sun.\n\n"Kind of a ring thing, comes with a dialer, you hit the symbols, it spins around and lights come on, it kind of flushes sideways..."</description>
        <graphicData>
            <texPath>Things/Building/Artifact/RGDHD</texPath>
            <graphicClass>Graphic_Multi</graphicClass>
            <drawSize>(1.75,1.75)</drawSize>
            <addTopAltitudeBias>true</addTopAltitudeBias>
        </graphicData>
        <size>(1,1)</size>
        <uiIconScale>0.5</uiIconScale>
        <minifiedDef>MinifiedThing</minifiedDef>
        <minifiedDrawScale>0.5</minifiedDrawScale>
        <stealable>true</stealable>
        <passability>Impassable</passability>
        <constructEffect>ConstructMetal</constructEffect>
        <fillPercent>0.40</fillPercent>
        <canOverlapZones>true</canOverlapZones>
        <leaveResourcesWhenKilled>true</leaveResourcesWhenKilled>
        <altitudeLayer>Building</altitudeLayer>
        <preventDroppingThingsOn>true</preventDroppingThingsOn>
        <thingCategories>
            <li>Artifacts</li>
        </thingCategories>
        <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
        <tickerType>Rare</tickerType>
        <drawerType>RealtimeOnly</drawerType>
        <hasInteractionCell>True</hasInteractionCell>
        <interactionCellOffset>(0,0,-1)</interactionCellOffset>
        <building>
            <ai_neverTrashThis>true</ai_neverTrashThis>
            <uninstallWork>3250</uninstallWork>
        </building>
        <placeWorkers>
            <li>PlaceWorker_ShowFacilitiesConnections</li>
            <li>PlaceWorker_PreventInteractionSpotOverlap</li>
        </placeWorkers>
        <comps>
            <li Class="CompProperties_Facility">
                <requiresLOS>false</requiresLOS>
                <maxSimultaneous>1</maxSimultaneous>
            </li>
            <li Class="Rimgate.CompProperties_DHDControl">
                <activeGraphicData>
                    <texPath>FX/RGDHD_Active</texPath>
                    <graphicClass>Graphic_Multi</graphicClass>
                    <shaderType>Mote</shaderType>
                    <drawSize>(1.75,1.75)</drawSize>
                </activeGraphicData>
            </li>
            <li Class="Rimgate.CompProperties_AnalyzableResearchWhen">
                <analysisID>1000600</analysisID>
                <requiresResearchDef>Rimgate_StargateAlloyResearch</requiresResearchDef>

                <!-- Analyzable -->

                <canStudyInPlace>true</canStudyInPlace>
                <destroyedOnAnalyzed>false</destroyedOnAnalyzed>
                <analysisDurationHours>10</analysisDurationHours>
                <completedLetterLabel>DHD studied: {RESEARCH} unlocked</completedLetterLabel>
                <completedLetter>By studying the DHD, {PAWN_labelShort} has acquired the insight needed for the research project(s) {RESEARCH}.\n\nYour researchers can now use research benches to begin researching how to actually use the technology.</completedLetter>
                <completedLetterDef>PositiveEvent</completedLetterDef>

                <catastrophicFailureChance>0.25</catastrophicFailureChance>
                <catastrophicDestroysThing>true</catastrophicDestroysThing>
                <catastrophicExplosion>true</catastrophicExplosion>
                <catastrophicExplosionRadius>3.0</catastrophicExplosionRadius>
                <catastrophicExplosionDamage>60</catastrophicExplosionDamage>
                <catastrophicExplosionDamageDef>Bomb</catastrophicExplosionDamageDef>
                <catastrophicBlocksResearch>true</catastrophicBlocksResearch>

                <catastrophicLetterLabelKey>RG_AnalysisCatastrophicLabel</catastrophicLetterLabelKey>
                <catastrophicLetterTextKey>RG_AnalysisCatastrophicText</catastrophicLetterTextKey>

                <!-- Interactable -->

                <maintainProgress>true</maintainProgress>
                <activateTexPath>UI/Icons/Study</activateTexPath>

                <activateLabelString>Analyze...</activateLabelString>
                <activateDescString>Analyze the DHD.</activateDescString>
                <jobString>Analyzing DHD</jobString>
                <guiLabelString>Choose who should analyze this</guiLabelString>
                <inspectString>Can be analyzed by a colonist.</inspectString>

                <targetingParameters>
                    <canTargetBuildings>false</canTargetBuildings>
                    <canTargetAnimals>false</canTargetAnimals>
                    <canTargetMechs>false</canTargetMechs>
                    <onlyTargetControlledPawns>true</onlyTargetControlledPawns>
                </targetingParameters>
            </li>
        </comps>
        <leaveResourcesWhenKilled>true</leaveResourcesWhenKilled>
        <killedLeavings>
            <Rimgate_ZPM>1</Rimgate_ZPM>
        </killedLeavings>
        <killedLeavingsChance>0.005</killedLeavingsChance>
        <statBases>
            <MaxHitPoints>6000</MaxHitPoints>
            <Flammability>0</Flammability>
            <Mass>90</Mass>
        </statBases>
        <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    </ThingDef>

    <!-- =============== ZPM =============== -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_ZPM</defName>
        <label>zero point module</label>
        <description>A self-contained miracle of Ancient technology, the ZPM draws energy from a subspace vacuum—basically finite power in a shiny cylinder. Makes other batteries look like AA cells from a cereal box.\n\nUnfortunately, such a thing is impossible to hide. Once installed in a power network, its archotech-grade signature will leak into the sky, luring factions across the Rim to your colony’s doorstep. Power eternal… and trouble unending.\n\n"It's kind of like a miniature universe in a bottle."</description>
        <thingClass>Rimgate.Building_ZPM</thingClass>
        <category>Building</category>
        <soundImpactDefault>BulletImpact_Metal</soundImpactDefault>
        <selectable>true</selectable>
        <drawerType>MapMeshAndRealTime</drawerType>
        <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
        <repairEffect>Repair</repairEffect>
        <size>(1,1)</size>
        <graphicData>
            <texPath>Things/Building/Artifact/ZPM/RGZPM</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <drawSize>1</drawSize>
            <shadowData>
                <volume>(0.27,0.25,0.27)</volume>
            </shadowData>
        </graphicData>
        <techLevel>Archotech</techLevel>
        <stackLimit>1</stackLimit>
        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>Artifacts</li>
        </thingCategories>
        <altitudeLayer>Building</altitudeLayer>
        <castEdgeShadows>false</castEdgeShadows>
        <fillPercent>1</fillPercent>
        <passability>PassThroughOnly</passability>
        <pathCost>150</pathCost>
        <tickerType>Rare</tickerType>
        <statBases>
            <WorkToMake>30000</WorkToMake>
            <MaxHitPoints>1000000</MaxHitPoints>
            <MarketValue>25000</MarketValue>
            <Flammability>0.0</Flammability>
            <Mass>20</Mass>
        </statBases>
        <building>
            <neverBuildable>true</neverBuildable>
            <canLandGravshipOn>true</canLandGravshipOn>
            <uninstallWork>6250</uninstallWork>
        </building>
        <tradeability>Buyable</tradeability>
        <tradeNeverStack>true</tradeNeverStack>
        <leaveResourcesWhenKilled>false</leaveResourcesWhenKilled>
        <resourcesFractionWhenDeconstructed>0</resourcesFractionWhenDeconstructed>
        <comps>
            <li Class="CompProperties_Battery">
                <storedEnergyMax>48000</storedEnergyMax>
                <efficiency>1</efficiency>
                <transmitsPower>true</transmitsPower>
                <shortCircuitInRain>false</shortCircuitInRain>
            </li>
            <li Class="CompProperties_Flickable" />
            <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities>
                    <li>Rimgate_SubspaceShroudEmitter</li>
                    <li>Rimgate_SubspacePhaseDiverter</li>
                </linkableFacilities>
            </li>
            <li Class="Rimgate.CompProperties_AnalyzableResearchWhen">
                <analysisID>1000500</analysisID>
                <requiresResearchDef>Electricity</requiresResearchDef>

                <!-- Analyzable -->

                <canStudyInPlace>true</canStudyInPlace>
                <destroyedOnAnalyzed>false</destroyedOnAnalyzed>
                <analysisDurationHours>10</analysisDurationHours>
                <completedLetterLabel>ZPM studied: {RESEARCH} unlocked</completedLetterLabel>
                <completedLetter>By studying the ZPM, {PAWN_labelShort} has acquired the insight needed for the research project(s) {RESEARCH}.\n\nYour researchers can now use research benches to begin researching how to actually use the technology.</completedLetter>
                <completedLetterDef>PositiveEvent</completedLetterDef>

                <catastrophicFailureChance>0.25</catastrophicFailureChance>
                <catastrophicDestroysThing>true</catastrophicDestroysThing>
                <catastrophicExplosion>true</catastrophicExplosion>
                <catastrophicExplosionRadius>3.0</catastrophicExplosionRadius>
                <catastrophicExplosionDamage>60</catastrophicExplosionDamage>
                <catastrophicExplosionDamageDef>Bomb</catastrophicExplosionDamageDef>
                <catastrophicBlocksResearch>true</catastrophicBlocksResearch>

                <catastrophicLetterLabelKey>RG_AnalysisCatastrophicLabel</catastrophicLetterLabelKey>
                <catastrophicLetterTextKey>RG_AnalysisCatastrophicText</catastrophicLetterTextKey>

                <!-- Interactable -->

                <maintainProgress>true</maintainProgress>
                <activateTexPath>UI/Icons/Study</activateTexPath>

                <activateLabelString>Analyze...</activateLabelString>
                <activateDescString>Analyze the ZPM.</activateDescString>
                <jobString>Analyzing ZPM</jobString>
                <guiLabelString>Choose who should analyze this</guiLabelString>
                <inspectString>Can be analyzed by a colonist.</inspectString>

                <targetingParameters>
                    <canTargetBuildings>false</canTargetBuildings>
                    <canTargetAnimals>false</canTargetAnimals>
                    <canTargetMechs>false</canTargetMechs>
                    <onlyTargetControlledPawns>true</onlyTargetControlledPawns>
                </targetingParameters>
            </li>
        </comps>
        <hasInteractionCell>False</hasInteractionCell>
    </ThingDef>

    <!-- =============== ARCHOTECH IDOL OF RESONANCE =============== -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_ArchotechIdolOfResonance</defName>
        <label>archotech idol of resonance</label>
        <description>A compact ancient artifact that hums in subspace harmonics. Nearby minds settle into an effortless focus—mood stabilizes, steps feel lighter, and even the stubborn find resolve. But listen too long and the static whispers back.</description>
        <category>Building</category>
        <thingClass>Building</thingClass>
        <selectable>true</selectable>
        <drawPlaceWorkersWhileSelected>false</drawPlaceWorkersWhileSelected>
        <altitudeLayer>Building</altitudeLayer>
        <rotatable>false</rotatable>
        <size>(1,1)</size>
        <graphicData>
            <texPath>Things/Building/Artifact/RGArchotechIdolOfResonance</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <drawSize>1</drawSize>
            <drawOffset>(0,0,0.1)</drawOffset>
        </graphicData>
        <thingCategories>
            <li>Artifacts</li>
        </thingCategories>
        <soundImpactDefault>BulletImpact_Metal</soundImpactDefault>
        <techLevel>Archotech</techLevel>
        <minifiedDef>MinifiedThing</minifiedDef>
        <tradeability>None</tradeability>
        <tradeTags Inherit="False" />
        <tradeNeverStack>true</tradeNeverStack>
        <tickerType>Rare</tickerType>
        <pathCost>0</pathCost>
        <neverMultiSelect>true</neverMultiSelect>
        <useHitPoints>false</useHitPoints>
        <leaveResourcesWhenKilled>false</leaveResourcesWhenKilled>
        <statBases>
            <Beauty>25</Beauty>
            <Flammability>0</Flammability>
            <MarketValue>8000</MarketValue>
            <Mass>8</Mass>
        </statBases>
        <building>
            <neverBuildable>true</neverBuildable>
            <joyKind>Meditative</joyKind>
            <watchBuildingStandDistanceRange>1~5</watchBuildingStandDistanceRange>
            <watchBuildingStandRectWidth>1</watchBuildingStandRectWidth>
            <watchBuildingInSameRoom>true</watchBuildingInSameRoom>
            <artificialForMeditationPurposes>false</artificialForMeditationPurposes>
            <deconstructible>false</deconstructible>
            <claimable>true</claimable>
            <uninstallWork>6250</uninstallWork>
        </building>
        <comps>
            <li Class="CompProperties_Glower">
                <glowRadius>2.9</glowRadius>
                <glowColor>(120, 200, 255, 0)</glowColor>
            </li>
            <li Class="Rimgate.CompProperties_ResonanceIdol">
                <!-- gameplay tuning -->
                <radius>16</radius>
                <refreshTicks>1200</refreshTicks> <!-- ~20s; re-applied by comp to keep buff alive -->
                <negativeThoughtMtbDays>12</negativeThoughtMtbDays>

                <!-- hediffs applied (hidden) -->
                <fieldBuffHediff>Rimgate_ResonanceFieldBuff</fieldBuffHediff>
                <hostBoostHediff>Rimgate_ResonanceHostBoost</hostBoostHediff>

                <!-- thoughts -->
                <thoughtNear>Rimgate_ResonanceCalm</thoughtNear>
                <thoughtNearForWraith>Rimgate_ResonanceWraithSatiation</thoughtNearForWraith>
                <thoughtNegative>Rimgate_ResonanceStaticVoices</thoughtNegative>
            </li>
        </comps>
        <placeWorkers>
            <li>Rimgate.PlaceWorker_ResonanceIdol</li>
            <li>Rimgate.PlaceWorker_Stargate</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>
        <thingSetMakerTags Inherit="False" />
    </ThingDef>

    <!-- ======================= Ancient Research Bank ======================= -->

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_AncientResearchBank</defName>
        <label>ancient research bank</label>
        <description>A self-contained data core from a vanished civilization, still humming faintly with stored knowledge.\n\nWhen interfaced with a modern research bench, it boosts analysis speed by 35% through active cross-referencing of ancient archives and predictive heuristics.\n\nLimit one per workbench — most minds can only handle so much enlightenment at once.</description>
        <graphicData>
            <texPath>Things/Building/Artifact/RGAncientDatabase</texPath>
            <graphicClass>Graphic_Multi</graphicClass>
            <drawSize>(1,1)</drawSize>
            <drawOffsetNorth>(0,0,0.45)</drawOffsetNorth>
            <drawOffsetSouth>(0,0,-0.05)</drawOffsetSouth>
            <drawOffsetWest>(-0.25,0,0)</drawOffsetWest>
            <drawOffsetEast>(0.25,0,0)</drawOffsetEast>
            <damageData>
                <enabled>false</enabled>
            </damageData>
        </graphicData>
        <statBases>
            <WorkToBuild>1200</WorkToBuild>
            <Mass>20</Mass>
        </statBases>
        <uiIconScale>0.75</uiIconScale>
        <size>(1,1)</size>
        <altitudeLayer>BuildingOnTop</altitudeLayer>
        <passability>PassThroughOnly</passability>
        <castEdgeShadows>false</castEdgeShadows>
        <staticSunShadowHeight>0.51</staticSunShadowHeight>
        <fillPercent>0.5</fillPercent>
        <canOverlapZones>false</canOverlapZones>
        <rotatable>true</rotatable>
        <terrainAffordanceNeeded IsNull="True" />
        <pathCost>15</pathCost>
        <statBases>
            <MaxHitPoints>100</MaxHitPoints>
            <Mass>20</Mass>
            <Flammability>0.5</Flammability>
        </statBases>
        <building>
            <isEdifice>false</isEdifice>
            <isAttachment>true</isAttachment>
            <destroySound>BuildingDestroyed_Metal_Small</destroySound>
            <claimable>true</claimable>
            <isInert>true</isInert>
            <neverBuildable>true</neverBuildable>
            <alwaysDeconstructible>true</alwaysDeconstructible>
            <canLandGravshipOn>true</canLandGravshipOn>
            <uninstallWork>6250</uninstallWork>
        </building>
        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>BuildingsMisc</li>
        </thingCategories>
        <placeWorkers>
            <li>PlaceWorker_ShowFacilitiesConnections</li>
            <li>Placeworker_AttachedToWall</li>
        </placeWorkers>
        <comps>
            <li Class="CompProperties_Facility">
                <statOffsets>
                    <ResearchSpeedFactor>0.35</ResearchSpeedFactor>
                </statOffsets>
                <maxSimultaneous>1</maxSimultaneous>
                <mustBePlacedAdjacent>true</mustBePlacedAdjacent>
            </li>
            <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <shortCircuitInRain>false</shortCircuitInRain>
                <basePowerConsumption>225</basePowerConsumption>
            </li>
        </comps>
    </ThingDef>

</Defs>