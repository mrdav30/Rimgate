<?xml version="1.0" encoding="UTF-8"?>
<Defs>

    <ThingDef ParentName="BuildingBase">
        <defName>Rimgate_TokraClimateControlCrystal</defName>
        <label>Climate crystal</label>
        <description>A Tok'ra-grown crystal lattice used to regulate underground habitats. It does not generate heat or cold so much as it *convinces* the air to behaveâ€”drawing warmth from crowded bodies, shedding it into stone, and reversing the flow just as easily.\n\nDespite its clean geometry, the lattice is alive. Neglect it and the resonance decays into inert glass. Feed it raw naquadah to maintain growth, then set a target temperature and let the crystal do what Tok'ra technology does best: quietly make the impossible look mundane.</description>

        <thingClass>Rimgate.Building_TokraClimateCrystal</thingClass>

        <graphicData>
            <texPath>Things/Building/Temperature/RGTokraClimateCrystal_Idle</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <shaderType>CutoutComplex</shaderType>
            <drawSize>(1,1)</drawSize>
        </graphicData>

        <minifiedDef>MinifiedThing</minifiedDef>
        <thingCategories>
            <li>BuildingsTemperature</li>
        </thingCategories>
        <designationCategory>Temperature</designationCategory>

        <size>(1,1)</size>
        <neverMultiSelect>true</neverMultiSelect>
        <rotatable>false</rotatable>
        <altitudeLayer>Building</altitudeLayer>
        <passability>PassThroughOnly</passability>
        <pathCost>30</pathCost>
        <fillPercent>0.2</fillPercent>
        <useHitPoints>true</useHitPoints>
        <statBases>
            <MaxHitPoints>180</MaxHitPoints>
            <Mass>6</Mass>
            <Flammability>0</Flammability>
            <Beauty>6</Beauty>
            <WorkToBuild>4200</WorkToBuild>
            <MarketValue>1800</MarketValue>
        </statBases>
        <tickerType>Rare</tickerType>
        <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>

        <stuffCategories>
            <li>Stony</li>
        </stuffCategories>
        <costStuffCount>40</costStuffCount>
        <costList>
            <Rimgate_Naquadah>15</Rimgate_Naquadah>
            <Silver>10</Silver>
            <Gold>5</Gold>
        </costList>

        <researchPrerequisites>
            <li>Rimgate_TokraClimateControl</li>
        </researchPrerequisites>
        <constructionSkillPrerequisite>5</constructionSkillPrerequisite>

        <placeWorkers>
            <li>PlaceWorker_Heater</li>
        </placeWorkers>
        <drawPlaceWorkersWhileSelected>true</drawPlaceWorkersWhileSelected>

        <comps>
            <li Class="CompProperties_TempControl">
                <!-- Similar order of magnitude to heater/cooler tuning; adjust for balance -->
                <energyPerSecond>22</energyPerSecond>
                <lowPowerConsumptionFactor>0.1</lowPowerConsumptionFactor>
            </li>

            <!-- Refuelable: no auto-consume; we consume only when actively heating/cooling -->
            <li Class="CompProperties_Refuelable">
                <fuelCapacity>25</fuelCapacity>
                <fuelConsumptionRate>0</fuelConsumptionRate>
                <fuelLabel>Naquadah</fuelLabel>
                <fuelGizmoLabel>Naquadah</fuelGizmoLabel>
                <showAllowAutoRefuelToggle>true</showAllowAutoRefuelToggle>
                <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
                <showFuelGizmo>true</showFuelGizmo>
                <fuelFilter>
                    <thingDefs>
                        <li>Rimgate_Naquadah</li>
                    </thingDefs>
                </fuelFilter>
                <initialFuelPercent>0.5</initialFuelPercent>
                <minimumFueledThreshold>0.05</minimumFueledThreshold>
            </li>

            <li Class="CompProperties_Glower">
                <glowRadius>2</glowRadius>
                <glowColor>(97,135,127,0)</glowColor>
            </li>
        </comps>

        <modExtensions>
            <li Class="Rimgate.TokraClimateCrystalDefModExt">
                <!-- Max temp delta it will attempt to correct per rare tick -->
                <maxDeltaPerRareTick>1.6</maxDeltaPerRareTick>

                <!-- Fuel used per degree actually changed (per rare tick) -->
                <fuelPerDegree>0.06</fuelPerDegree>

                <!-- Optional: efficiency falloff if target is extreme -->
                <softClampMin>-10</softClampMin>
                <softClampMax>40</softClampMax>

                <texPathIdle>Things/Building/Temperature/RGTokraClimateCrystal_Idle</texPathIdle>
                <texPathHeating>Things/Building/Temperature/RGTokraClimateCrystal_Heating</texPathHeating>
                <texPathCooling>Things/Building/Temperature/RGTokraClimateCrystal_Cooling</texPathCooling>
            </li>
        </modExtensions>
    </ThingDef>

</Defs>