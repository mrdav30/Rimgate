<?xml version="1.0" encoding="UTF-8"?>
<Defs>

    <!-- ==================== Wraith Drain ==================== -->

    <HediffDef>
        <defName>Rimgate_WraithLifeDrainTarget</defName>
        <label>life drained</label>
        <description>The telltale weakness of being fed on by a Wraith.\nVictims experience fatigue, tremors, and a general sense of “please don’t do that again.”\n\nHaving one's life force sapped not only leaves them weakened and vulnerable, but repeated feeding will lead to death.</description>
        <defaultLabelColor>(0.9, 1.0, 0.35)</defaultLabelColor>
        <hediffClass>HediffWithComps</hediffClass>
        <tendable>false</tendable>
        <isBad>true</isBad>
        <initialSeverity>0.1</initialSeverity>
        <maxSeverity>1.0</maxSeverity>
        <lethalSeverity>1.0</lethalSeverity>
        <alwaysShowSeverity>true</alwaysShowSeverity>
        <comps>
            <li Class="HediffCompProperties_Disappears">
                <disappearsAfterTicks>240000</disappearsAfterTicks> <!-- 4 days -->
                <!-- <showRemainingTime>true</showRemainingTime> -->
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
        </comps>
        <stages>
            <li>
                <capMods>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>-0.2</offset>
                    </li>
                    <li>
                        <capacity>Consciousness</capacity>
                        <offset>-0.3</offset>
                    </li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>-0.2</offset>
                    </li>
                    <li>
                        <capacity>Hearing</capacity>
                        <offset>-0.2</offset>
                    </li>
                    <li>
                        <capacity>Breathing</capacity>
                        <offset>-0.25</offset>
                    </li>
                    <li>
                        <capacity>BloodFiltration</capacity>
                        <offset>-0.2</offset>
                    </li>
                </capMods>
                <statFactors>
                    <InjuryHealingFactor>0.25</InjuryHealingFactor>
                    <ImmunityGainSpeed>0.25</ImmunityGainSpeed>
                    <RestRateMultiplier>0.25</RestRateMultiplier>
                    <RestFallRateFactor>2.5</RestFallRateFactor>
                </statFactors>
            </li>
        </stages>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>
    </HediffDef>

    <!-- ==================== Wraith Regen ==================== -->

    <HediffDef>
        <defName>Rimgate_WraithLifeDrainRegen</defName>
        <label>life-empowered</label>
        <description>Vitality stolen from another being surges through this pawn, enhancing reflexes and healing rate.\nNot RDA-approved. But effective.</description>
        <defaultLabelColor>(0.6, 0.6, 1.0)</defaultLabelColor>
        <hediffClass>HediffWithComps</hediffClass>
        <tendable>false</tendable>
        <isBad>false</isBad>
        <comps>
            <li Class="HediffCompProperties_Disappears">
                <disappearsAfterTicks>120000</disappearsAfterTicks> <!-- 2 days -->
                <!-- <showRemainingTime>true</showRemainingTime> -->
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
        </comps>
        <stages>
            <li>
                <capMods>
                    <li>
                        <capacity>Consciousness</capacity>
                        <offset>0.4</offset>
                    </li>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>0.3</offset>
                    </li>
                    <li>
                        <capacity>Sight</capacity>
                        <offset>0.2</offset>
                    </li>
                    <li>
                        <capacity>Hearing</capacity>
                        <offset>0.2</offset>
                    </li>
                    <li>
                        <capacity>Breathing</capacity>
                        <offset>0.2</offset>
                    </li>
                    <li>
                        <capacity>BloodFiltration</capacity>
                        <offset>0.3</offset>
                    </li>
                </capMods>
                <statFactors>
                    <InjuryHealingFactor>2</InjuryHealingFactor>
                    <ImmunityGainSpeed>2</ImmunityGainSpeed>
                </statFactors>
            </li>
        </stages>
        <duplicationAllowed>false</duplicationAllowed>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>
    </HediffDef>

    <!-- ==================== Psylink on Spawn ==================== -->

    <HediffDef Name="Rimgate_InitPsylinkBase" Abstract="true">
        <label>psionic attunement</label>
        <description>This hediff adds psylink levels to a pawn then removes itself.</description>
        <scenarioCanAdd>false</scenarioCanAdd>
        <isBad>false</isBad>
        <tendable>false</tendable>
        <initialSeverity>0.1</initialSeverity>
        <hediffClass>HediffWithComps</hediffClass>
        <!-- <comps>
            <li Class="Rimgate.HediffCompProperties_GivePsylinkOnAdded">
                tuning per pawnkind
                <minLevel>2</minLevel>
                <maxLevel>4</maxLevel>
                <extraPsycasts>1~3</extraPsycasts>
                Optional filter so only “control/disruption” flavored casts are picked
                You may also create your own tag strings and add them to AbilityDefs
                <whiteListAbilityDefs>
                    <li>Calm</li>
                    <li>Shock</li>
                    <li>Vertigo</li>
                    <li>Chaos</li>
                </whiteListAbilityDefs>
                <blackListAbilityDefs>
                    <li>Calm</li>
                    <li>Shock</li>
                    <li>Vertigo</li>
                    <li>Chaos</li>
                </blackListAbilityDefs>
            </li>
        </comps> -->
        <!-- Keep it invisible to players -->
        <stages>
            <li>
                <label>attuning</label>
                <minSeverity>0</minSeverity>
                <becomeVisible>false</becomeVisible>
                <capMods />
            </li>
        </stages>

        <duplicationAllowed>false</duplicationAllowed>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>

        <comps>
            <!-- make sure this goes away -->
            <li Class="HediffCompProperties_Disappears">
                <disappearsAfterTicks>30000</disappearsAfterTicks> <!-- half a day -->
                <showRemainingTime>true</showRemainingTime>
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
        </comps>
    </HediffDef>

    <HediffDef ParentName="Rimgate_InitPsylinkBase">
        <defName>Rimgate_InitPsylinkWraith</defName>
        <comps>
            <li Class="Rimgate.HediffCompProperties_GivePsylinkOnAdded">
                <minLevel>2</minLevel>
                <maxLevel>3</maxLevel>
                <extraPsycasts>1~2</extraPsycasts>
                <blackListAbilityCategories>
                    <li>Skip</li>
                    <li>WordOf</li>
                </blackListAbilityCategories>
                <blackListAbilityDefs>
                    <li>BerserkPulse</li>
                    <li>Neuroquake</li>
                </blackListAbilityDefs>
            </li>
        </comps>
    </HediffDef>

    <!-- ==================== Tracking Drone Support ==================== -->

    <!-- Caster Hediff -->

    <ThingDef ParentName="MoteBase">
        <defName>Mote_TrackingRelay</defName>
        <thingClass>MoteAttached</thingClass>
        <altitudeLayer>LightingOverlay</altitudeLayer>
        <drawOffscreen>true</drawOffscreen>
        <mote>
            <solidTime>9999999</solidTime>
            <needsMaintenance>true</needsMaintenance>
        </mote>
        <graphicData>
            <graphicClass>Graphic_Mote</graphicClass>
            <texPath>FX/RGTrackingRelayMask</texPath>
            <shaderType>MoteGlow</shaderType>
            <color>(155, 216, 219)</color>
            <drawSize>20</drawSize>
        </graphicData>
    </ThingDef>

    <HediffDef>
        <defName>Rimgate_TrackingRelay</defName>
        <label>tracking relay</label>
        <defaultLabelColor>(0.52, 1, 0.95)</defaultLabelColor>
        <description>This mechanoid is supplying real-time combat analysis and tactical data to nearby allies, enhancing their effectiveness in combat.</description>
        <hediffClass>HediffWithComps</hediffClass>
        <isBad>false</isBad>
        <stages>
            <li>
                <capMods>
                    <li>
                        <capacity>Moving</capacity>
                        <offset>-0.2</offset>
                    </li>
                </capMods>
            </li>
        </stages>

        <duplicationAllowed>false</duplicationAllowed>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>

        <comps>
            <li Class="HediffCompProperties_Disappears">
                <showRemainingTime>True</showRemainingTime>
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
            <li Class="HediffCompProperties_GiveHediffsInRange">
                <range>9.9</range>
                <mote>Mote_TrackingRelay</mote>
                <hideMoteWhenNotDrafted>true</hideMoteWhenNotDrafted>
                <targetingParameters>
                    <canTargetBuildings>false</canTargetBuildings>
                    <canTargetAnimals>false</canTargetAnimals>
                    <canTargetMechs>false</canTargetMechs>
                    <onlyTargetColonists>true</onlyTargetColonists>
                </targetingParameters>
                <hediff>Rimgate_TacticalSupportBuff</hediff>
            </li>
        </comps>
    </HediffDef>

    <!-- Ally Buff-->

    <ThingDef ParentName="MoteBase">
        <defName>Mote_TacticalSupportLinkLine</defName>
        <thingClass>MoteDualAttached</thingClass>
        <altitudeLayer>MoteLow</altitudeLayer>
        <mote>
            <fadeInTime>0.1</fadeInTime>
            <fadeOutTime>0.1</fadeOutTime>
            <solidTime>999999</solidTime>
            <needsMaintenance>True</needsMaintenance>
            <rotateTowardsTarget>True</rotateTowardsTarget>
            <scaleToConnectTargets>True</scaleToConnectTargets>
        </mote>
        <graphicData>
            <shaderType>MoteGlow</shaderType>
            <texPath>FX/RGTacticalSupportLinkLine</texPath>
        </graphicData>
    </ThingDef>

    <HediffDef>
        <defName>Rimgate_TacticalSupportBuff</defName>
        <label>tactical support</label>
        <defaultLabelColor>(0.52, 1, 0.95)</defaultLabelColor>
        <description>Combat abilities are boosted thanks to being supplied combat data from a nearby mechanoid.</description>
        <debugLabelExtra>other</debugLabelExtra>
        <hediffClass>HediffWithComps</hediffClass>
        <isBad>false</isBad>
        <stages>
            <li>
                <statOffsets>
                    <ShootingAccuracyPawn>5</ShootingAccuracyPawn>
                    <MortarMissRadiusFactor>-0.5</MortarMissRadiusFactor>
                    <AimingDelayFactor>-0.2</AimingDelayFactor>
                </statOffsets>
            </li>
        </stages>

        <duplicationAllowed>false</duplicationAllowed>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>

        <comps>
            <li Class="HediffCompProperties_Disappears">
                <showRemainingTime>false</showRemainingTime>
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
            <li Class="HediffCompProperties_Link">
                <requireLinkOnOtherPawn>false</requireLinkOnOtherPawn>
                <maxDistance>10</maxDistance>
                <customMote>Mote_TacticalSupportLinkLine</customMote>
            </li>
        </comps>
    </HediffDef>

    <!-- ==================== Unas Roar ==================== -->

    <HediffDef>
        <defName>Rimgate_UnasRoar</defName>
        <label>unas' roar</label>
        <hediffClass>HediffWithComps</hediffClass>
        <description>This creature has been shaken by the powerful roar of an Unas.</description>

        <duplicationAllowed>false</duplicationAllowed>
        <allowMothballIfLowPriorityWorldPawn>true</allowMothballIfLowPriorityWorldPawn>

        <stages>
            <li>
                <capMods>
                    <li>
                        <capacity>Manipulation</capacity>
                        <postFactor>0.85</postFactor>
                    </li>
                    <li>
                        <capacity>Moving</capacity>
                        <postFactor>0.75</postFactor>
                    </li>
                    <li>
                        <capacity>Hearing</capacity>
                        <postFactor>0.5</postFactor>
                    </li>
                </capMods>
            </li>
        </stages>

        <comps>
            <li Class="HediffCompProperties_Disappears">
                <showRemainingTime>true</showRemainingTime>
            </li>
            <li Class="HediffCompProperties_DisappearsOnDeath" />
        </comps>
    </HediffDef>

</Defs>